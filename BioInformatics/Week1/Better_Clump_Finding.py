def numToPattern(idx, k):
    if k == 1:
        return numToSymbol(idx)
    return numToPattern(int(idx / 4), k - 1) + numToSymbol(idx % 4)


def numToSymbol(sym):
    if sym == 0:
        return 'A'
    if sym == 1:
        return 'C'
    if sym == 2:
        return 'G'
    if sym == 3:
        return 'T'

def patternToNum(pattern):
    if pattern == '':
        return 0
    return 4 * patternToNum(pattern[:-1]) + symbolToNum(pattern[-1])


def symbolToNum(sym):
    if sym == 'A':
        return 0
    if sym == 'C':
        return 1
    if sym == 'G':
        return 2
    if sym == 'T':
        return 3




def computing_freq(txt, k):
    freqArr={}
    for i in range(4**k):
        freqArr[i] =0
    for i in range(len(txt) - k+1):
        j = patternToNum(txt[i:i+k])
        freqArr[j] += 1
    return freqArr



def better_clump_finding(genome, k, L, t):
    frequent_Patterns = set()
    Clump = [0 for i in range(4**k)]
    text = genome[:L]
    Frequency_Array = computing_freq(text, k)
    count = []
    index = []
    #print('Frequency_Array', Frequency_Array)
    for i in range(4**k):
        if Frequency_Array[i] >= t:
            Clump[i] = 1
    for i in range(1, len(genome) - L + 1):
        FirstPattern = genome[i-1: i-1+k]
        index = patternToNum(FirstPattern)
        Frequency_Array[index] -= 1

        LastPattern = genome[i + L - k: i + L]
        index = patternToNum(LastPattern)
        Frequency_Array[index] += 1
        if Frequency_Array[index] >= t:
            Clump[index] = 1
    for i in range(4**k):
        if Clump[i] == 1:
            pattern = numToPattern(i, k)
            frequent_Patterns.add(pattern)
    return ' '.join(frequent_Patterns)

#print(' '.join(map(str, computing_freq('AATACACAACTTATTTTTTTTAACCGTAGTATCTGGAACTCATTCGGAGTTTCTTCCTAATCAGAGAATCTATTCGGTAATGGAGGCACCGTCACATAGATATACGATACCCAGCGTCTTGGTGGGGGCTCCTAAATATGCCAATTCTGGTCTCGTGACATTGCCACTTCGCGGCATCTTGCCAGTTTGGACGTCCCAGTTTTTTTTCGGCCTTACTACGAGCTGACACTCTCTCGCAGAACATCGTTGGCATTCCGACCAATACAGCGTTATGAAATAGGCGAGCTCGGGAACGAAGTTACGCCTAGCCTAGAGGATGGAACGCAGTCACGAAAAGAAAAATCGCTCTGTCTTGTGCCTATGGCAATAAGAGTCTCTGGGGGCCTAGATGACTGGCCTTTAGGGTTATGGGTTTACTCTATGGATCCTGGAGACGGACCCTTTTTTCTTAATCAAACTCAAACCCTTCCTAACATCTCGGATACTGAGTGGCCTCATGTTGCCTGGGCCTAAAGGGGAACGCGATATGGCCCCTGTCTCGGATGGGGTCCCCACGCATTCTCTCTTAATCGGTAAAACCACAACCGGTGGCTGGAAACAAATGTTGGTGTGATCTTCGTTGTCATTGTCAACTCTTCCTAA', 7).values())))
#print(better_clump_finding('GCGGCGGCCTGCGATTAGTGCTGGCTTCACGGGCCGGCTTCTGAAGGACAGCAACTCCGTTTTGGACAGGGACGCTAGAGCCGGTTTTCAGGATAACGTCCAGACTCGTGCCTATGCCTTGGTGTCGAATTGGGCCGCATTGACGAGCCAGTAGGGAGTATCTTATAGTGGTTATTGGTTTTGAACAGTTCATCCAGTTATACCGGCAGCCCGTATACCAGCGGCAGACAAGAAAAATATAGCTGCTTGGATGCATTGGATGCAGATATAATAGCCTTTTGGATGCAATCTGTGCCGGATTTTGGATGCACGGCTGTAAAAGGGTCTTTGACCTAGGGTCTTTGAGGTCTTTGAGGGGCGCCGCGGGTTGGATGCAGTGGTCTTTGGGTCTTTGAGGTGGTCTTTGAGCAATTGCGTCACGGTCTTTGAGCTCTTGGATGTTTGGATGCACAAATCTCCGGTCTTTGACAGTTATTCTGGTCTTTGATTTTTGGTCTTTGATGCAATCGGTCTTTGAGTAAGCCTTGGATGCAGTCAAGGAGTTGGATGCACGAGACATAGGGTCTTTGATTTCGGTGAGCGAGTGTCCCCCATTTGGATGCATAGGTCTTTGATGCAGATGCAAGCTGCTCACCGGTCTTTGACTTTGATGAGATGCAGATGGACGTTGACTGTTTGGTCTTGGTCTTTGAGAGCGAGTCAGATCGGTGGTCTTTGATCTGGTCTTTGATGCATTGGATGCATCCGGTCTTTGAATCCGAGGTAGACCGCGGGTCGGTCTTTGAGTTTTGGATGCACAGGATGCATTGGTCTTTGAGTAACACTGGTCTTTGAACTCTACAAGGTCTTTGAGCCCGGGGTCTTTGAGAGCCGCGCCAGGGCACGGTCTTTGATACCCGGACGTAACACTCATAATGTTCGTCGTAACACTATACCATATTGGCGTAACACTGGCTACGCCCGCTTCTAAGACCTAAATTCGTACTACGCCCGTACGCCCGGTAACCGTAACACTACACTCCTACGCCCGCTCAATGCTCTACGCCCTACGCCCGACACTACACTCTACGCCCGCGCCCGTACCATGGTAGTAGCTGCTACGCCCGCACCAAACTACGCCCGGGTCTACGCCCGCCGGGTCTACGCCCGGCCCGAAATTGCGTAACACCTACGCCCCTACGCCCGTCTTTTCTCGTAACACTACAATACCCACTACCTACGCCCGCCGCTGTTCAAAGCAAGCGCGTAACACTACGCCCGCTCTCCACCCTACGCCCGAGAGCTACGCCCGGGATATCTACGCCCGGTACGCCCGGACTACGCCCGGTAACACTTTCCGTAACACTACCGTAACACTGCGTACTACGCCCGTTGTAGGATCTAGGATCCTTTTCCTGGGGCTTGAGGATAACTTGAGAGCTCAGGCCTACGCCCGTACGCCCGCCAATCGTGTACTCGAACTTGATGCCTAGTCATATGAGATAGGATCTAGGATCCTAATAGGATCTAGGATCCTTAGGCGAAATAGTCTAGGATCCTCCACTAGGATCCTTAACTCTCAGCGAGTTTTAGGATCCTAAATATGCGATAGGCTGACCTGGGCGTTTAGTAGGATCCTCCGTACCTTATTAGGATCCTAATCAGAGTAGTAGGATCCTCGTCGTTAAAGGTAACTTCAACTAGTGGTGAAGAAAGATTAGGATCCTCTCGATAGGATCCTTTGTAACTATAGGATCCTCCTGAGCTAGGATCCTTTAGGATCCTCCATAGGATCCTAGGATCCTAGGATCCTTAGGATCCTGGTATAGCCGACTCGAACAACATGTAGGATCCTGGGAGGATGAGGAAAGATTATTGGATTTGGCGGAGTCAACACTTTGCCGCGATCCTGCCGTGTGGGTAAAGACATATTATCGCGGTTCGTACAGAGGAGGAGTTTACCTCATACAGAGGAGCCGTTGCGGAAGACCTCTCTAAACTTGTCTACAGAGGAGATACAGAGGAGGGAGTTCGTGGAACAGAGGAGCCTGACAGAGGAACAGAGGAGTAACAGAGGAGACTGAATGACCGGACAGAGGAGAGTATTGTACAGAGGAGAGCACGACTCGGGGTCCGTTCAGCGATTCAAGACAGACAGAGGAGAGAGGAGACAGTACCACGGGCCGTACGTGTAATGACTTGTTACAGAGGAGCATGTCAGAGAGAAAATCTTATTCAAACCACTTAAACAGAGGAGTGGACCCGTACAGAGGAGACAAGTCACAGAGGAGAGTACAGAGGAGCGCCCACAGAGGAGCCCAAGATAACGCTTGTATTATGCACAGCCGCTTGTATGTACCTTGATATAGATACATCTGACAGTGCAACAGAGGAGTACTCAAGGAAACAGCGTTACAGAGGAGCAGAGGAGGACGCCCCGTACTATATGGAACACAGACAGAGGCGCTTGTATCCGCTTGTATTCGACGCCGCTTGTATTCTAAAACAGACGCTTGCGCTTGTATCATCGAACTGGACGCGGACCCCGGACGCTCCATTCTTCGACGCGGCGCTTGTATGGTTGACCGCTTGTATCGCTTGTATGTATACGCGACGCGCGCTTGTACGCTTGTATGACCACTATAGCGCTTGTATGGACGCGGCCTGACGCGGACCTGGTTAGGCGACGCCGCTTGTATCGAATCTTCGATGAAGACGCTGTCTACCAAGCTACGCTTGTATGCGGACGATACGACGCGGACATGCCAATGACGCGGACAACTTAGGACGCGGACCTCGCGCTTGTATTGTATGTCTGGAAGCGTGACGCCGCTTGTATGGACACGCTTGTACGCTTGTATACGGCGCTTGTATATGACGCTTGTATCACGACGCGGACCTAACGCTTGTATCAGTGTGTCCTGAGACGCGGACTATTATGCCGAGAGGAAGTTTCACACAGTTTTTGGGGGACGCGGACGCAAATGACGCGGACATTCACTATGACGCGGACTGGGGGTACCCGCACGTTCTAGACGCGGACAGGCCCGGCCCTCGCATCGCGATTAACCGACGCGGACGAGTTTAATACACCAGTCGTTGACGCGGACGTCCCCAAGAGCCAAGCCTGCCGAGCTGACTGGATATACTAGGTCGCCGGAGCGGAACTCCCGGGTAAATGACGGACGGTCCCCATTGTGTCTGCCTGGAAGTAGTACCTCCGTATCAAGATTATCACCAGCCAGCACTTTCCATGCTCGGTTAGACTGTTCACCCTCTTCGCACACCAATCCAGAACTATCAAAGAGTTCTAATATACATCAAGGCCGTCGCACGCCGAGATATAAACCCCAGAGCGTGAGGCTTGTATCCTGGGCTTGGGGAATCTTGATACTGGGGTCTAACTACCACACTCAGTTGTTACTACTGGAGATACAAGCAAAGCGATTGATCACACTGAGTCATATGAGGCGGCATTGCACCCCCGCTCCGAGGAGGGTTGGCCGGAGAATGAGAGGTCTCCGAGAAGTTTAGATGTTGCATTTTCAGATTCAACTGAGCTGTAAATCACGTCAAAAAGGAGCTAATACAGTTCCGCTACTCGACGTCACAATATCGGAGTCTAGGGTATGACAACCGATCACTGTGATTAGTTGATGAATCATTAGAATGGAGCGACGCAGTTATCATCGGACTGTTAATGCCGTATCCAGTAACATCAAAGGGTATGAGGCAATCAACACCCCCTAATATATCGACACCCCCGTGCAGAGTACCGTTCCTTTCGATCTGCTTCGGAAGAAGGGAGAACGATTCATTGCGAGCGAGTGTATTATCTTTCCTAGAGAGTCGCGGAACCGTCTTAGTCGTCGTGCAAGGTGACGGGCCTAGACATCTCACTCTAAGGCATCATCTTAACTTTTTTTGACAAATGAACTGTGCGTGAGTCCCTCAATGCTACATCGCTGATCGTATTGTTCGAGTGCGGCGCCGTTAGCACACGTGTCCGGTATAGCGAAATCAGGAGCATAGTCGTGGGTGTACAAGTAAGTCAAAGCTTTGCCTTCGTCCCGCTTGAAACCTATGGATGTCGACGTGGTATTACTCCGTGGTGGGCCCGGCAAACAAGTGGTGGTTATTTCGACACGCGGACGCGGGTTGCGATGAGGACGCGTGCGGACGACACGCGGACACGCGGCGAATGTAATGAAGAGACGAGTGAGAGTCAGTCAACACCACACCCTTGAGCATAGACACGCGGCCGATCAGCCCACACATCCCACTTGACACGCGGACACGCGGACGAGACACGGACACGCGGTATAGACTAACCTATAATTTACGACAGACACGCGGGACGGACCTGCCAAGGGACACGACACGCGGTCCTACATTGTCTAGATAGCCTGTGAGAAACTGACAGACACGGACACGCGGGACACGCGGAGACACGCGGTTCCATGCATTAAGAGGAGACGTGCTGGTCGACACGCGGTTTATTTCGGTGCCCGTTTGGGCAGACACGCGGATGTGAAGCACAGACACGCGGACACGCGGCGCGGCGTCAAGAACCCCCAAACAGATACCGCAGACTCTAGACACGCGGCTAGCGACACGCGGACGGACATGATGCTCTCAATCGTGGGTGGACACGCGGCGATCTTGCCGAGTTCAACTGAAGCCTGGAAGACACGCGGGGCCGCGGTGCATTTGGCATCGTTGTCGAGGTCATCTGTTTAATCGTTGTCATTCGCGCATTATCGTTGTCTTGTCCATCGTTGTCCGGCACCAATGACCACCTATCATCGTTGTCCGAGCTTCTTGCCCTCTACGTACCGCCAAGGCGATCGTTGTCTTCGCCCATCGTTGTCTGCATTGTACAGCCATCGTTGTCCTGGATCGTTGTCAACGAAGTTAGGATCGTTGTCTGTCGTGCACCTTACAGCGCTGCCTCGGAGCCAATCGTTGTCTGCACGTCGAAATCGTTGTCTGATGGGTTCGGCGTCTTTGATAGATCACGTTAAGGAAGGGATCGTTGTCATCGTTGTCCGTTGTCGTTGCGGCGCATAAAGAGTAAGATCAAATCGTTGTCCCATCGTTGATCGTTGTCGTTGTCCTCCTAAAATAAAATATGAAAGTATCTAACATCGTTGTCGAATCGTTGTCCGTTGTCGGGCATCGTTGTCCGTTGTCTCTAGTTGTGATCCCCGTAGTCTGAAAAGAAATGGATGTCAGCGGGGGATTCTGTTATTCCTCTCTATCGTTGTCAAAGTTCCCGATCGTTGTCAGGCAAACCGCCGAATCGTTGTCAGCCTGAGTAGCCACTGCCGACACGCCCGTTTCGAAGCTCGTCCCTCGGCGTCATGCCAGCGGATTGTCAGCAAGTAACATATAAATCCAAGCTGTTCGGGCACCATATGCCGGTAAGGCTGATACTTGGAATTACCCGGTGAGGGCGAGCATCAGTCCTGTGTTAAGCTCTGTGAAGAGGAAAAATTCGATTAGTTGCGTGCCTAGCGATCCTGGGGAAATTTGACCTGAGGTTGTTCTCCGCATGCATATTTGTTTGAAAGGAGGCCGCCGCCACGGGTGCTTAAGTCACTGGCACAGAACGAATAGTCAAAGATGGGTGACACTCGGCAATCTACAGCAAGGTGTACAGCATACGTCCGGTAGGCGATAATAGACTTCAATTGCACTCTCAGTTTCTCGGAAGATGCCGTAAGGGGGCGTCTAGAGGCTCGTCAAAAAAGGCTCAAGCCCACTTGTAATCGACAAGCTTATAACAGAGCGTAAAGTATTTAGTTCTCATCAAAAAGTACCATTAAAGACAGAGGCGACATAATAGGGGTTAATTTCCGCATATCATTCTAATTGGTCTGCGGCTTAATATTGGTGTGCTGCCACCGGACGACAGCTTACTCCCTGTGCAAAAGATTAACTCACCTCTTATGTCGGCGAGTTAAGGAAGCGTGCGGAGTGGCTCCAGCTCGCACAGGCCAGTTCTTTACTTTTCGAACGATATCTTTATTCAGCCACGATCCGGTTGTGTAGACGACTAACCATATGTAGAGATTACCTTTGCCTTATTGAGCGCGTCCTCGACCCTCCGACCTATACCTGTATCTGTAGCGGAAGCACAGCATAGCAGTAGGTTGCTCCCCACTGGCATCATGCTTGTAATGAGGAGCTAAAATCGCACAAACCGATTACGCGACCTTAACGGACGCGTAAGCGGAGACTCTTGCTAGGAATGACTGCCCAAGTCGGCGCGGCGTTAAGCCTGTCACTATACTCATTGTGTGCGCATCGATAGTGGTGAGCATCCGAATCTGCGCTCCTGAACGACAGAGGCAGTCGGAGATTGATCTCCGCGTGGGCTGCAACAACGATCACTGTGCCAATAGCGCACTTAGGTAGACGAGCCAATGATGTAAGACTCAGATTTGCCCCCCTGCTTCATGTTCGCCGGGAGGAGCCGCGAAGCCCCTGGATCTAACCCCTCCCCTGGATCCCCGTCACGACTCCCCTGGATGATTAGTAAATCCCCCCTGGATATTGGGTCCACTCTCCTTATGAGCCCCTGGATTGGTATGCTTGGACCATGACCACGAAGTACGAGGTATTGAGTTCCCCTGGATTCTGGGAACGTGTGTTAGCCCCTGGATTATAGTGGGCACGCACCTCGCCGCCAATCCCCTGGCCCCTGGATGGCCCCTGGATCCTGGATTGGAATTGAGGCCCAGTAAAATATAAGTACCCCCTGGATTTGCTACCCAGTTCCCCTGGATGATCCCCTGGATAAGGGACTATAGTTTTCCCCCCCTGGATATTACTCCCCTGGATCCTGTCCCGCCTATTGACGATCCGCACAGCCCCCTGGATTATCGGGAAAACCTCTCGCCCCTGGATAGCCCCTGGATACGTCTGAGTACCCCTGGATCGAGGTTGTCTCGAGCCCCCCTGGATTGCCCCTGGATCTGGATCCAACTAGACCCCCCTGGATAACCCCTGGATCCCTGGATACCCCCTGCCCCTGGATTGTGAATTGAGACGATGCTGCCAACAACAGCACCCCTAGCTCAGATACTCAAGGAAGGTCGCCGAATACTCGGAAAACTGAACTGGTAGGTACGTGTCTAAGCCGATAGCGGCTCCGGACCTGCCCTTTTTTCTTTGGCGAGTCTGAACAATCTTCAGACCAAAGTGTATATACGTTCCTGGGTCGATTAACTGGCTCTATAATGGCGGCAGTTTGTCACTACCGCGGGCTGAGATGAAGACCGTTGATTTGGCAGCAGGTCAGGGCTCCGCCGGCCCCGAGATCATAGGGAGTGACAGTGCCCCAATTAATTTGCTTGCGGATATTGTCATCTATTAACTGCACGATTCGTAAACAGGTCGGTGGTACTTGGGGGGGTGTGTATCAGGAGGCTATCACGCCTTAGTTCGCGGTTTCTCCCCCCCGTGCAATGATTGTACAATCAACGTAGGTTATTAAAAATTCACAATACGTGATGTTCTCGAAACCCGCTATTTATAGGCTCGGATAAAGCATGAGCCGAAAATAAGAGCATTACACGCGTTGAGATTCCCGGCGCTCAATAATAATTTCCCCCAATCTCCAATGTCATCACACATGCTTTTACGGTAGCGAAGGGTCGTCGTGATCTGGTCCTCTGAGAGTGACGCCCTCGATGGAAAGCTAGTGTATTATTGGCAACGCCTGCCGCACTGTTTGTATTTCTGAGTAAGTCGTGGTTACTATTTATTAAAGCTTTGCTGATCGCCTCCGTGCGTGTCGTTTACTTATCTGAGATCTTCTTGTCCTAATTACTTAAGTCCACCGCTAAAGCGTGGAAAGCAGTCGGATAGCCGGAGGTTATGGACGCAGACGTTCGTTCCTATTTTGCGCGGCCCCCGTGGCATAGGTATCACGAACAGCGGGTCTATTAAGCTGCTGGGGCGCGCTACCTCGGGCGACTAACGTAGTATCCTATCGTCGGATCAACCCTCTGAGAGTGCCAGTTTTCCAATTTGCTTCAGGTAAATACCAAACCTGCCTTGGGACCGAAGTATGTCCTTATATTTTAATTACGCCCTACTCCATACCGACCCGCCGTCGGGGTCACCGAACCGCCTCGGATCGGCGGACACTCTAGCAAGGGACATCTACAACTCAACTCGATTTAGCACATATGCAAAACTCGTTAGGGGATCGACTCGGTCTAACACAACTGTGGATTAGGCCGGCGAAAAGATTTTGCTATACTGCGATCGGGGCCCCGTCCTCCTCTCCCTGGATTCCTTCGAACCCCCGTAAGGTAAATCGGCCACGCACGGCGTTACGACAACACGGCTCGGGGGGGGCCAGAACATTGAAATCTTATGGCACCGGACCAGAGAGCGTGATTGTGGCTGGACGGCGTCGCTCCCATACGGGTGGAGTGTTCTGGCTTGGGAAACAGGTAATCCCGCCCCCCTTTAGGATGATATAGCCAGCGTAATACGAGCCTCGTTAAGTTCTGGAGCACAACACTGAGATTCTAAACGCCTTAGCGGAGCTGCCTCTACCATGAACCTAGCAGGTAAGCACCATTGGAAGGGTTGCCTATGGGTTTACGTCGGCTCATGGGCCGGGTACTCGACGGCTCATGGGATGGGCGGTAATTGGTTCTAACGTTTGTGGTGCTCATGGGGCTCATGGGCCTGCTCATGGGATGGGTTTGTGAGACGTCTTCCATTATTCACCGGATCGCTCATGGGGCTCATGGGCCTGTCTACGCTCATGGGTATCATGAGCTCATGGGGGGCTCATGGGTCACCGGGCTCATGGGCCTGATTGACGCTCTCAAGAACGGCAGCACCGGCTCATGGGCATGGGGGCTACGTTGAGGCTCATGGGCGCTCATGGGCCAGCTCATGGGTGGGCAGCTCATGGGGGGGGCCCTTATTTAAGGGACGATTTATCCCGCTGATTTGTGCGATTATATAATATATTGGCTCATGGGAGACAGATCCAGCTCATGGGACCTCGCTGAGCGCATGCTCATGGGTGCCGGTGACCGTGCTTCCGTGTATTGCTCATGGGCAAGGCGGCAACCAGTACTCCCCTCTATTACGGACACAATTAGCAGTCTGCTCAGCTCATGGGTTTTCGGACCCGTCAAAAACCACTCTGGCAGGCGCTCATGGGATATCTCTAAGGCCGCCGCGCAGATGTCAATCAAAGTTCAATGCTGATCGGTAGGTCCAACTCATCGTACTCGCAGGGTGTTTTACTCGTAGACCCACGGGCGCGTAAGACAGGGGGTTATGACGCATGTAACGCTGGGGTGGTTCAGGGCATACGCCTGAACATTGCCGCCAGCCCGTAACGCCGCCCGTAGCCCGTAACCCCGTAACGCCCGTAACGCCCGTAACGCCCGTAACGCCGCCCGTAACCGTAGCCCGTAACACGCCCGGCCCGTAACTAACGCCCGTAACGCCCGTAACGCCCGTAACGCCCGTAACGGCCCGTAACCCCGTAACGGCCCGTAACCCCGTAACGCCCGTAACGCCCGTAACGCCCGTAACGCCCGTAAC', 9, 507, 16))

print(numToPattern(7602, 9))